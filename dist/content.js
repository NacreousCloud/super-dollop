class y{static analyzeElement(t){var l;const e=((l=t.tagName)==null?void 0:l.toLowerCase())||"unknown",s=this.getRole(t),i=this.getAccessibleName(t),a=this.getAttributes(t),r=this.generateSelectorStrategies(t,s,i),n=this.analyzeAccessibility(t,s,i,r);return{id:this.generateId(t),tag:e,role:s,accessibleName:i,attributes:a,selectorStrategies:r,hasAccessibilityIssues:n.overallScore<70,labelingImprovements:n.improvements}}static getRole(t){var a;const e=t.getAttribute("role");if(e)return e;const s=((a=t.tagName)==null?void 0:a.toLowerCase())||"unknown";return{button:"button",a:t.hasAttribute("href")?"link":void 0,input:this.getInputRole(t),select:"combobox",textarea:"textbox",main:"main",nav:"navigation",header:"banner",footer:"contentinfo",aside:"complementary",section:"region",article:"article",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading"}[s]}static getInputRole(t){var i;const e=((i=t.type)==null?void 0:i.toLowerCase())||"text";return{button:"button",submit:"button",reset:"button",checkbox:"checkbox",radio:"radio",range:"slider",search:"searchbox"}[e]||"textbox"}static getAccessibleName(t){var a,r,n,l;const e=t.getAttribute("aria-label");if(e!=null&&e.trim())return e.trim();const s=t.getAttribute("aria-labelledby");if(s){const u=s.split(/\s+/).map(d=>{var f,p;return(p=(f=document.getElementById(d))==null?void 0:f.textContent)==null?void 0:p.trim()}).filter(Boolean).join(" ");if(u)return u}if(((a=t.tagName)==null?void 0:a.toLowerCase())==="input"){const u=t.getAttribute("id");if(u){const d=document.querySelector(`label[for="${u}"]`);if((r=d==null?void 0:d.textContent)!=null&&r.trim())return d.textContent.trim()}}if(((n=t.tagName)==null?void 0:n.toLowerCase())==="img"){const u=t.getAttribute("alt");if(u!==null)return u}const i=(l=t.textContent)==null?void 0:l.trim();if(i&&i.length<100)return i}static getAttributes(t){const e={};for(let s=0;s<t.attributes.length;s++){const i=t.attributes[s];e[i.name]=i.value}return e}static generateSelectorStrategies(t,e,s){const i={accessibility:{score:0,selector:"",available:!1},name:{score:0,selector:"",available:!1},testid:{score:0,selector:"",available:!1},css:{score:0,selector:"",available:!1}};if(e&&(i.accessibility={score:90,selector:`[role="${e}"]`,available:!0}),s){const n=t.getAttribute("aria-label")?`[aria-label="${s}"]`:`[aria-labelledby*="${t.getAttribute("aria-labelledby")}"]`;i.name={score:85,selector:n,available:!0}}const a=t.getAttribute("data-testid");a&&(i.testid={score:95,selector:`[data-testid="${a}"]`,available:!0});const r=this.generateCSSSelector(t);return i.css={score:Math.max(30,70-r.split(" ").length*10),selector:r,available:!0},i}static generateCSSSelector(t){var i,a;const e=[];let s=t;for(;s&&s.nodeType===Node.ELEMENT_NODE&&e.length<6;){let r=((i=s.nodeName)==null?void 0:i.toLowerCase())||"unknown";if(s.id){r+=`#${CSS.escape(s.id)}`,e.unshift(r);break}const n=Array.from(((a=s.parentElement)==null?void 0:a.children)||[]).filter(l=>l.nodeName===s.nodeName);if(n.length>1&&s){const l=n.indexOf(s)+1;r+=`:nth-of-type(${l})`}e.unshift(r),s=s.parentElement}return e.join(" > ")}static analyzeAccessibility(t,e,s,i){const a=[],r=[];let n=100;if(e||(a.push("역할(role)이 명시되지 않음"),r.push("적절한 role 속성 추가"),n-=20),!s&&this.needsAccessibleName(t)&&(a.push("접근 가능한 이름이 없음"),r.push("aria-label 또는 연결된 label 추가"),n-=25),t.getAttribute("data-testid")||(r.push("data-testid 속성 추가 (테스트 안정성)"),n-=5),this.isInteractive(t)){const l=t;!t.hasAttribute("tabindex")&&l.tabIndex<0&&(a.push("키보드 접근이 불가능"),r.push("tabindex 속성 확인"),n-=15)}return{overallScore:Math.max(0,n),recommendations:r,criticalIssues:a.filter(l=>l.includes("접근 가능한 이름")||l.includes("키보드 접근")),improvements:r}}static needsAccessibleName(t){var i;const e=((i=t.tagName)==null?void 0:i.toLowerCase())||"unknown";return["button","a","input","select","textarea"].includes(e)||t.hasAttribute("role")}static isInteractive(t){var i;const e=((i=t.tagName)==null?void 0:i.toLowerCase())||"unknown";return["button","a","input","select","textarea"].includes(e)||t.hasAttribute("onclick")||t.hasAttribute("role")&&["button","link","menuitem","tab"].includes(t.getAttribute("role"))}static generateId(t){var e;return t.getAttribute("data-testid")||t.getAttribute("id")||`${((e=t.tagName)==null?void 0:e.toLowerCase())||"unknown"}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}let c=null,b=!1,g=null,h=null;function m(){return c||(c=document.createElement("div"),c.style.position="fixed",c.style.zIndex="2147483647",c.style.pointerEvents="none",c.style.border="2px solid #5b9cff",c.style.background="rgba(91,156,255,0.15)",c.style.borderRadius="3px",document.documentElement.appendChild(c),c)}function x(){c==null||c.remove(),c=null}function A(o){const t=o.getBoundingClientRect();return{left:t.left,top:t.top,width:t.width,height:t.height}}function w(o){const t=A(o),e=m();e.style.left=t.left+"px",e.style.top=t.top+"px",e.style.width=Math.max(0,t.width)+"px",e.style.height=Math.max(0,t.height)+"px";const s=y.analyzeElement(o),i=s.selectorStrategies.accessibility.score+s.selectorStrategies.name.score+s.selectorStrategies.testid.score;i>180?(e.style.border="2px solid #10b981",e.style.background="rgba(16,185,129,0.15)"):i>120?(e.style.border="2px solid #f59e0b",e.style.background="rgba(245,158,11,0.15)"):(e.style.border="2px solid #ef4444",e.style.background="rgba(239,68,68,0.15)")}function S(){b||(b=!0,m(),g=o=>{const t=o.target;t&&w(t)},h=o=>{o.preventDefault(),o.stopPropagation();const t=o.target;if(!t)return;const e=y.analyzeElement(t);chrome.runtime.sendMessage({type:"ELEMENT_PICKED",payload:{role:e.role,name:e.accessibleName,selector:e.selectorStrategies.css.selector,detailedAnalysis:e}}),v()},window.addEventListener("mousemove",g,!0),window.addEventListener("click",h,!0),document.body.style.cursor="crosshair")}function v(){b&&(b=!1,window.removeEventListener("mousemove",g,!0),window.removeEventListener("click",h,!0),g=null,h=null,document.body.style.cursor="",x())}chrome.runtime.onMessage.addListener((o,t,e)=>{o.type==="START_INSPECT"?S():o.type==="STOP_INSPECT"?v():o.type==="PING"&&e({ok:!0})});
//# sourceMappingURL=content.js.map
