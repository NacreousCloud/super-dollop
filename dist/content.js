class f{static analyzeElement(t){const e=t.tagName.toLowerCase(),s=this.getRole(t),i=this.getAccessibleName(t),o=this.getAttributes(t),a=this.generateSelectorStrategies(t,s,i),r=this.analyzeAccessibility(t,s,i,a);return{id:this.generateId(t),tag:e,role:s,accessibleName:i,attributes:o,selectorStrategies:a,hasAccessibilityIssues:r.overallScore<70,labelingImprovements:r.improvements}}static getRole(t){const e=t.getAttribute("role");if(e)return e;const s=t.tagName.toLowerCase();return{button:"button",a:t.hasAttribute("href")?"link":void 0,input:this.getInputRole(t),select:"combobox",textarea:"textbox",main:"main",nav:"navigation",header:"banner",footer:"contentinfo",aside:"complementary",section:"region",article:"article",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading"}[s]}static getInputRole(t){const e=t.type.toLowerCase();return{button:"button",submit:"button",reset:"button",checkbox:"checkbox",radio:"radio",range:"slider",search:"searchbox"}[e]||"textbox"}static getAccessibleName(t){var o,a;const e=t.getAttribute("aria-label");if(e!=null&&e.trim())return e.trim();const s=t.getAttribute("aria-labelledby");if(s){const r=s.split(/\s+/).map(l=>{var g,h;return(h=(g=document.getElementById(l))==null?void 0:g.textContent)==null?void 0:h.trim()}).filter(Boolean).join(" ");if(r)return r}if(t.tagName.toLowerCase()==="input"){const r=t.getAttribute("id");if(r){const l=document.querySelector(`label[for="${r}"]`);if((o=l==null?void 0:l.textContent)!=null&&o.trim())return l.textContent.trim()}}if(t.tagName.toLowerCase()==="img"){const r=t.getAttribute("alt");if(r!==null)return r}const i=(a=t.textContent)==null?void 0:a.trim();if(i&&i.length<100)return i}static getAttributes(t){const e={};for(let s=0;s<t.attributes.length;s++){const i=t.attributes[s];e[i.name]=i.value}return e}static generateSelectorStrategies(t,e,s){const i={accessibility:{score:0,selector:"",available:!1},name:{score:0,selector:"",available:!1},testid:{score:0,selector:"",available:!1},css:{score:0,selector:"",available:!1}};if(e&&(i.accessibility={score:90,selector:`[role="${e}"]`,available:!0}),s){const r=t.getAttribute("aria-label")?`[aria-label="${s}"]`:`[aria-labelledby*="${t.getAttribute("aria-labelledby")}"]`;i.name={score:85,selector:r,available:!0}}const o=t.getAttribute("data-testid");o&&(i.testid={score:95,selector:`[data-testid="${o}"]`,available:!0});const a=this.generateCSSSelector(t);return i.css={score:Math.max(30,70-a.split(" ").length*10),selector:a,available:!0},i}static generateCSSSelector(t){var i;const e=[];let s=t;for(;s&&s.nodeType===Node.ELEMENT_NODE&&e.length<6;){let o=s.nodeName.toLowerCase();if(s.id){o+=`#${CSS.escape(s.id)}`,e.unshift(o);break}const a=Array.from(((i=s.parentElement)==null?void 0:i.children)||[]).filter(r=>r.nodeName===s.nodeName);if(a.length>1&&s){const r=a.indexOf(s)+1;o+=`:nth-of-type(${r})`}e.unshift(o),s=s.parentElement}return e.join(" > ")}static analyzeAccessibility(t,e,s,i){const o=[],a=[];let r=100;if(e||(o.push("역할(role)이 명시되지 않음"),a.push("적절한 role 속성 추가"),r-=20),!s&&this.needsAccessibleName(t)&&(o.push("접근 가능한 이름이 없음"),a.push("aria-label 또는 연결된 label 추가"),r-=25),t.getAttribute("data-testid")||(a.push("data-testid 속성 추가 (테스트 안정성)"),r-=5),this.isInteractive(t)){const l=t;!t.hasAttribute("tabindex")&&l.tabIndex<0&&(o.push("키보드 접근이 불가능"),a.push("tabindex 속성 확인"),r-=15)}return{overallScore:Math.max(0,r),recommendations:a,criticalIssues:o.filter(l=>l.includes("접근 가능한 이름")||l.includes("키보드 접근")),improvements:a}}static needsAccessibleName(t){const e=t.tagName.toLowerCase();return["button","a","input","select","textarea"].includes(e)||t.hasAttribute("role")}static isInteractive(t){const e=t.tagName.toLowerCase();return["button","a","input","select","textarea"].includes(e)||t.hasAttribute("onclick")||t.hasAttribute("role")&&["button","link","menuitem","tab"].includes(t.getAttribute("role"))}static generateId(t){return t.getAttribute("data-testid")||t.getAttribute("id")||`${t.tagName.toLowerCase()}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}let c=null,u=!1,d=null,b=null;function p(){return c||(c=document.createElement("div"),c.style.position="fixed",c.style.zIndex="2147483647",c.style.pointerEvents="none",c.style.border="2px solid #5b9cff",c.style.background="rgba(91,156,255,0.15)",c.style.borderRadius="3px",document.documentElement.appendChild(c),c)}function m(){c==null||c.remove(),c=null}function v(n){const t=n.getBoundingClientRect();return{left:t.left,top:t.top,width:t.width,height:t.height}}function x(n){const t=v(n),e=p();e.style.left=t.left+"px",e.style.top=t.top+"px",e.style.width=Math.max(0,t.width)+"px",e.style.height=Math.max(0,t.height)+"px";const s=f.analyzeElement(n),i=s.selectorStrategies.accessibility.score+s.selectorStrategies.name.score+s.selectorStrategies.testid.score;i>180?(e.style.border="2px solid #10b981",e.style.background="rgba(16,185,129,0.15)"):i>120?(e.style.border="2px solid #f59e0b",e.style.background="rgba(245,158,11,0.15)"):(e.style.border="2px solid #ef4444",e.style.background="rgba(239,68,68,0.15)")}function A(){u||(u=!0,p(),d=n=>{const t=n.target;t&&x(t)},b=n=>{n.preventDefault(),n.stopPropagation();const t=n.target;if(!t)return;const e=f.analyzeElement(t);chrome.runtime.sendMessage({type:"ELEMENT_PICKED",payload:{role:e.role,name:e.accessibleName,selector:e.selectorStrategies.css.selector,detailedAnalysis:e}}),y()},window.addEventListener("mousemove",d,!0),window.addEventListener("click",b,!0),document.body.style.cursor="crosshair")}function y(){u&&(u=!1,window.removeEventListener("mousemove",d,!0),window.removeEventListener("click",b,!0),d=null,b=null,document.body.style.cursor="",m())}chrome.runtime.onMessage.addListener((n,t,e)=>{n.type==="START_INSPECT"?A():n.type==="STOP_INSPECT"?y():n.type==="PING"&&e({ok:!0})});
//# sourceMappingURL=content.js.map
